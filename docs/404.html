<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<base href="/">
<title>載入中…</title>
<script src="marked.min.js"></script>
<style>
  :root {
    --unit: 8px;
    --radius-sm: 6px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --c-bg: #ffffff;
    --c-surface: #f8fafc;
    --c-text: #0f172a;
    --c-text-secondary: #475569;
    --c-text-muted: #94a3b8;
    --c-border: #e2e8f0;
    --c-accent: #2563eb;
    --c-accent-soft: #dbeafe;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.07), 0 2px 4px -2px rgba(0,0,0,0.05);
    --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.08), 0 4px 6px -4px rgba(0,0,0,0.04);
    --ease: cubic-bezier(0.4, 0, 0.2, 1);
    --duration: 200ms;
  }

  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  @media (prefers-reduced-motion: reduce) {
    html { scroll-behavior: auto; }
    *, *::before, *::after { transition-duration: 0.01ms !important; }
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, "Noto Sans TC", sans-serif;
    font-size: 17px;
    color: var(--c-text);
    background: var(--c-bg);
    line-height: 1.7;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* ── Top Bar ── */
  .topbar {
    position: sticky;
    top: 0;
    z-index: 10;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--c-border);
    padding: 12px 24px;
  }
  .topbar-inner {
    max-width: 780px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .topbar-back {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.88rem;
    font-weight: 500;
    color: var(--c-accent);
    text-decoration: none;
    padding: 6px 14px;
    border-radius: 99px;
    background: var(--c-accent-soft);
    transition: background var(--duration) var(--ease), box-shadow var(--duration) var(--ease);
    flex-shrink: 0;
  }
  .topbar-back:hover {
    background: #bfdbfe;
    box-shadow: var(--shadow-sm);
  }
  .topbar-back:focus-visible {
    outline: 2px solid var(--c-accent);
    outline-offset: 2px;
  }
  .topbar-back svg { width: 16px; height: 16px; }
  .topbar-filename {
    font-size: 0.88rem;
    color: var(--c-text-muted);
    font-family: "SF Mono", "Fira Code", "Consolas", monospace;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  /* ── Article ── */
  .article-wrap {
    max-width: 780px;
    margin: 0 auto;
    padding: 48px 24px 80px;
  }

  /* ── Loading / Error / 404 ── */
  .status {
    text-align: center;
    padding: 80px 24px;
    color: var(--c-text-muted);
    font-size: 1.05rem;
  }
  .status.error {
    color: #dc2626;
  }
  .status-icon {
    font-size: 2.5rem;
    margin-bottom: 16px;
    display: block;
  }
  .not-found {
    text-align: center;
    padding: 120px 24px 80px;
    max-width: 480px;
    margin: 0 auto;
  }
  .not-found-code {
    font-size: 5rem;
    font-weight: 800;
    color: var(--c-border);
    letter-spacing: -0.04em;
    line-height: 1;
    margin-bottom: 16px;
  }
  .not-found-msg {
    font-size: 1.15rem;
    color: var(--c-text-secondary);
    margin-bottom: 32px;
    line-height: 1.6;
  }
  .not-found-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.95rem;
    font-weight: 500;
    color: var(--c-accent);
    text-decoration: none;
    padding: 10px 20px;
    border-radius: 99px;
    background: var(--c-accent-soft);
    transition: background var(--duration) var(--ease), box-shadow var(--duration) var(--ease);
  }
  .not-found-link:hover {
    background: #bfdbfe;
    box-shadow: var(--shadow-sm);
  }
  .not-found-link:focus-visible {
    outline: 2px solid var(--c-accent);
    outline-offset: 2px;
  }

  /* ── Markdown Styles ── */
  .article h1, .article h2, .article h3, .article h4, .article h5, .article h6 {
    font-weight: 700;
    line-height: 1.3;
    margin-top: 2em;
    margin-bottom: 0.6em;
    color: var(--c-text);
  }
  .article h1 {
    font-size: 1.8rem;
    letter-spacing: -0.025em;
    margin-top: 0;
    padding-bottom: 12px;
    border-bottom: 2px solid var(--c-border);
  }
  .article h2 {
    font-size: 1.4rem;
    letter-spacing: -0.02em;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--c-border);
  }
  .article h3 { font-size: 1.15rem; }
  .article h4 { font-size: 1rem; }

  .article p {
    margin-bottom: 1em;
    line-height: 1.8;
  }

  .article ul, .article ol {
    margin-bottom: 1em;
    padding-left: 1.5em;
  }
  .article li {
    margin-bottom: 0.4em;
    line-height: 1.8;
  }
  .article li > ul, .article li > ol {
    margin-top: 0.4em;
    margin-bottom: 0;
  }

  .article a {
    color: var(--c-accent);
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: color var(--duration) var(--ease);
  }
  .article a:hover { color: #1d4ed8; }

  .article strong { font-weight: 700; }
  .article em { font-style: italic; }

  /* ── Inline Code ── */
  .article code {
    font-family: "SF Mono", "Fira Code", "Consolas", monospace;
    font-size: 0.88em;
    background: var(--c-surface);
    border: 1px solid var(--c-border);
    border-radius: var(--radius-sm);
    padding: 2px 6px;
  }

  /* ── Code Blocks ── */
  .article pre {
    margin-bottom: 1.2em;
    background: #1e293b;
    color: #e2e8f0;
    border-radius: var(--radius-md);
    padding: 20px;
    overflow-x: auto;
    line-height: 1.6;
    box-shadow: var(--shadow-sm);
  }
  .article pre code {
    background: none;
    border: none;
    padding: 0;
    font-size: 0.88rem;
    color: inherit;
  }

  /* ── Blockquotes ── */
  .article blockquote {
    margin-bottom: 1.2em;
    padding: 12px 20px;
    border-left: 4px solid var(--c-accent);
    background: var(--c-accent-soft);
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    color: var(--c-text-secondary);
  }
  .article blockquote p:last-child { margin-bottom: 0; }

  /* ── Tables ── */
  .article table {
    width: 100%;
    margin-bottom: 1.2em;
    border-collapse: collapse;
    font-size: 0.92rem;
  }
  .article th, .article td {
    border: 1px solid var(--c-border);
    padding: 10px 14px;
    text-align: left;
    line-height: 1.6;
  }
  .article th {
    background: var(--c-surface);
    font-weight: 700;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: var(--c-text-secondary);
  }
  .article tr:hover { background: #f8fafc; }

  /* ── Images ── */
  .article img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-md);
    margin: 8px 0;
  }

  /* ── Horizontal Rule ── */
  .article hr {
    border: none;
    border-top: 1px solid var(--c-border);
    margin: 2em 0;
  }

  /* ── Responsive ── */
  @media (max-width: 768px) {
    .topbar { padding: 10px 16px; }
    .article-wrap { padding: 32px 16px 64px; }
    .article h1 { font-size: 1.5rem; }
    .article h2 { font-size: 1.2rem; }
    .article pre { padding: 14px; font-size: 0.82rem; }
  }

  @media (max-width: 375px) {
    .article h1 { font-size: 1.3rem; }
    .article-wrap { padding: 24px 14px 48px; }
  }
</style>
</head>
<body>

<!-- ── Top Bar (hidden for 404) ── -->
<nav class="topbar" id="topbar" style="display:none">
  <div class="topbar-inner">
    <a class="topbar-back" href="skill-showcase-v2.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
      返回展示頁
    </a>
    <span class="topbar-filename" id="filename"></span>
  </div>
</nav>

<!-- ── Content ── -->
<div id="app"></div>

<script>
  (function() {
    var BASE = '/';
    var path = location.pathname;

    // Strip base path (support both custom domain and github.io)
    var LEGACY_BASE = '/orz99-skills/';
    if (path.indexOf(LEGACY_BASE) === 0) {
      path = path.substring(LEGACY_BASE.length);
    } else if (path.indexOf(BASE) === 0) {
      path = path.substring(BASE.length);
    }
    // Strip trailing slash
    if (path.length > 0 && path[path.length - 1] === '/') {
      path = path.substring(0, path.length - 1);
    }

    var app = document.getElementById('app');

    // Route: /good-writing → redirect to showcase
    if (path === 'good-writing') {
      location.replace(BASE + 'skill-showcase-v2.html');
      return;
    }

    // Route: /view/<slug>
    var viewMatch = path.match(/^view\/([a-zA-Z0-9_-]+)$/);
    if (viewMatch) {
      var slug = viewMatch[1];
      var mdFile = slug + '.md';

      // Show topbar
      document.getElementById('topbar').style.display = '';
      document.getElementById('filename').textContent = mdFile;
      document.title = slug + ' — 文章閱讀';

      app.innerHTML = '<div class="article-wrap"><div id="content"><div class="status">載入中…</div></div></div>';

      fetch(BASE + mdFile)
        .then(function(res) {
          if (!res.ok) throw new Error(res.status);
          return res.text();
        })
        .then(function(md) {
          document.getElementById('content').innerHTML = '<div class="article">' + marked.parse(md) + '</div>';
        })
        .catch(function() {
          document.getElementById('content').innerHTML = '<div class="status error"><span class="status-icon">!</span>找不到檔案：' + mdFile + '<br><br><a href="skill-showcase-v2.html" style="color:#2563eb">返回展示頁</a></div>';
        });
      return;
    }

    // Fallback: real 404
    document.title = '404 — 找不到頁面';
    app.innerHTML =
      '<div class="not-found">' +
        '<div class="not-found-code">404</div>' +
        '<p class="not-found-msg">找不到這個頁面。<br>可能是網址有誤，或頁面已移除。</p>' +
        '<a class="not-found-link" href="skill-showcase-v2.html">前往 Skills 效果展示</a>' +
      '</div>';
  })();
</script>

</body>
</html>
